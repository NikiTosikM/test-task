## Подготовка к запуску 
1) Клонируем github репозиорий командой: git clone https://github.com/NikiTosikM/test-task.git
2) В корневой директории создаем файл .env <br>
Пример .env файла: <br>
```
APP__HOST = 0.0.0.0
APP__PORT = 8000
APP__RELOAD = True

DB__DB_NAME = db_name
DB_ECHO = True

MODE = LOCAL
```

## Запуск проекта
1) Создаем docker image: <br>
```
docker build . -t app:latest
```
2) Запускаем контейнер: <br>
```
docker run --evn-file .env -p 8000:8000 app:latest
```

## Краткое описание моделей данных

***Lead*** 
* Уникальный идентификатор клиента - email
* Связан с контрактами

***Operator*** 
* Имя
* Статус активности
* Максимальная нагрузка
* Связан с источниками и контрактами 

***Source***
* Название источника
* Связан с операторами и контрактами

***Contract***
* Хранит лида, источник, оператора


***OperatorSource***
* Связывает вес клиента с источником 
* Ссылается на источника и оператора 


## Алгоритм распределения заявок
***Идентификация лида***
* Лиды определяются по email как уникальному идентификатору
* get_or_create_lead(email) находит существующего или создает нового лида

***Учет весов операторов***
* Веса хранятся в таблице OperatorSource (operator_id, source_id, weight)
* При выборе оператора учитываются веса для конкретного источника
* Используется взвешенная случайная выборка на основе весов

**Учет лимитов нагрузки***
* Проверяется operator.is_active и operator.current_load < operator.max_load
* current_load вычисляется как количество контрактов оператора

***Если операторов нет***
* Если нет доступных операторов → исключение OperatorNotFound
